<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register Your Store | Marketplace</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .registration-container {
            max-width: 600px;
            margin: 3rem auto;
            padding: 2.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            background-color: white;
        }
        .form-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        .form-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #6c757d;
        }
        .password-strength {
            height: 4px;
            margin-top: 8px;
            background-color: #e9ecef;
            border-radius: 2px;
            overflow: hidden;
        }
        .strength-0 { width: 20%; background-color: #dc3545; }
        .strength-1 { width: 40%; background-color: #fd7e14; }
        .strength-2 { width: 60%; background-color: #ffc107; }
        .strength-3 { width: 80%; background-color: #20c997; }
        .strength-4 { width: 100%; background-color: #198754; }
        .password-rules {
            font-size: 0.85rem;
            color: #6c757d;
        }
        .vendor-logo-preview {
            max-width: 150px;
            max-height: 150px;
            display: none;
            margin-top: 10px;
            border-radius: 8px;
            border: 1px dashed #dee2e6;
        }
    </style>
</head>
<body class="bg-light">
    <div class="registration-container">
        <div class="form-header">
            <h2 class="mb-3"><i class="fas fa-store-alt me-2"></i>Register Your Store</h2>
            <p class="text-muted">Get started by creating your vendor account</p>
        </div>
        
        <form method="post" action="/register-vendor" enctype="multipart/form-data" id="vendorRegistrationForm" novalidate>
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

            <!-- Vendor Information -->
            <div class="mb-4">
                <h5 class="mb-3"><i class="fas fa-info-circle me-2"></i>Store Information</h5>
                
                <div class="mb-3">
                    <label for="name" class="form-label">Store Name*</label>
                    <input type="text" class="form-control" id="name" name="name" 
                           required minlength="3" maxlength="50">
                    <div class="form-text">This will be displayed to customers (3-50 characters)</div>
                </div>
                
                <div class="mb-3">
                    <label for="description" class="form-label">Store Description</label>
                    <textarea class="form-control" id="description" name="description" 
                              rows="3" maxlength="500"></textarea>
                    <div class="form-text">Tell customers about your business (max 500 characters)</div>
                </div>
                
                <div class="mb-3">
                    <label for="logo" class="form-label">Store Logo</label>
                    <input type="file" class="form-control" id="logo" name="logo" accept="image/*">
                    <img id="logoPreview" class="vendor-logo-preview" alt="Logo preview">
                </div>
            </div>

            <!-- Admin Account -->
            <div class="mb-4">
                <h5 class="mb-3"><i class="fas fa-user-shield me-2"></i>Admin Account</h5>
                
                <div class="mb-3">
                    <label for="email" class="form-label">Email Address*</label>
                    <input type="email" class="form-control" id="email" name="email" required>
                    <div class="form-text">This will be your login and contact email</div>
                </div>
                
                <div class="mb-3 position-relative">
                    <label for="password" class="form-label">Password*</label>
                    <input type="password" class="form-control" id="password" name="password" 
                           required minlength="8" aria-describedby="passwordHelp">
                    <i class="fas fa-eye-slash form-icon" id="togglePassword"></i>
                    <div class="password-strength mt-2" id="passwordStrength"></div>
                    <div id="passwordHelp" class="form-text password-rules">
                        Password must contain:
                        <ul class="mb-0">
                            <li id="lengthRule">At least 8 characters</li>
                            <li id="uppercaseRule">One uppercase letter</li>
                            <li id="numberRule">One number</li>
                            <li id="specialRule">One special character</li>
                        </ul>
                    </div>
                </div>
                
                <div class="mb-3 position-relative">
                    <label for="confirmPassword" class="form-label">Confirm Password*</label>
                    <input type="password" class="form-control" id="confirmPassword" 
                           name="confirm_password" required>
                    <i class="fas fa-eye-slash form-icon" id="toggleConfirmPassword"></i>
                    <div class="invalid-feedback" id="passwordMatchFeedback">
                        Passwords do not match
                    </div>
                </div>
            </div>

            <!-- Business Details -->
            <div class="mb-4">
                <h5 class="mb-3"><i class="fas fa-briefcase me-2"></i>Business Details</h5>
                
                <div class="mb-3">
                    <label for="businessType" class="form-label">Business Type*</label>
                    <select class="form-select" id="businessType" name="business_type" required>
                        <option value="" disabled selected>Select your business type</option>
                        <option value="individual">Individual/Sole Proprietor</option>
                        <option value="llc">LLC</option>
                        <option value="corporation">Corporation</option>
                        <option value="partnership">Partnership</option>
                        <option value="nonprofit">Nonprofit</option>
                    </select>
                </div>
                
                <div class="mb-3">
                    <label for="taxId" class="form-label">Tax ID/EIN</label>
                    <input type="text" class="form-control" id="taxId" name="tax_id">
                    <div class="form-text">Required for tax reporting in some regions</div>
                </div>
            </div>

            <!-- Terms and Conditions -->
            <div class="mb-4 form-check">
                <input type="checkbox" class="form-check-input" id="terms" name="terms" required>
                <label class="form-check-label" for="terms">
                    I agree to the <a href="/terms" target="_blank">Terms of Service</a> and 
                    <a href="/privacy" target="_blank">Privacy Policy</a>*
                </label>
                <div class="invalid-feedback">
                    You must agree to the terms to register
                </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary w-100 py-2 mb-3">
                <i class="fas fa-store me-2"></i>Register Store
            </button>
            
            <div class="text-center">
                Already have a store? <a href="/vendor/login">Sign in to your vendor account</a>
            </div>
        </form>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('vendorRegistrationForm');
            const passwordInput = document.getElementById('password');
            const confirmPasswordInput = document.getElementById('confirmPassword');
            const togglePassword = document.getElementById('togglePassword');
            const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');
            const passwordStrength = document.getElementById('passwordStrength');
            const logoInput = document.getElementById('logo');
            const logoPreview = document.getElementById('logoPreview');
            const passwordRules = {
                length: document.getElementById('lengthRule'),
                uppercase: document.getElementById('uppercaseRule'),
                number: document.getElementById('numberRule'),
                special: document.getElementById('specialRule')
            };
            
            // Logo preview
            logoInput.addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        logoPreview.style.display = 'block';
                        logoPreview.src = e.target.result;
                    }
                    reader.readAsDataURL(file);
                }
            });
            
            // Toggle password visibility
            [togglePassword, toggleConfirmPassword].forEach(icon => {
                icon.addEventListener('click', function() {
                    const input = this.id === 'togglePassword' ? passwordInput : confirmPasswordInput;
                    const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
                    input.setAttribute('type', type);
                    this.classList.toggle('fa-eye');
                    this.classList.toggle('fa-eye-slash');
                });
            });
            
            // Password strength checker
            passwordInput.addEventListener('input', function() {
                const password = this.value;
                let strength = 0;
                
                // Length check
                if (password.length >= 8) {
                    strength++;
                    passwordRules.length.style.color = '#198754';
                    passwordRules.length.innerHTML = '✓ At least 8 characters';
                } else {
                    passwordRules.length.style.color = '#dc3545';
                    passwordRules.length.innerHTML = 'At least 8 characters';
                }
                
                // Uppercase check
                if (/[A-Z]/.test(password)) {
                    strength++;
                    passwordRules.uppercase.style.color = '#198754';
                    passwordRules.uppercase.innerHTML = '✓ One uppercase letter';
                } else {
                    passwordRules.uppercase.style.color = '#dc3545';
                    passwordRules.uppercase.innerHTML = 'One uppercase letter';
                }
                
                // Number check
                if (/\d/.test(password)) {
                    strength++;
                    passwordRules.number.style.color = '#198754';
                    passwordRules.number.innerHTML = '✓ One number';
                } else {
                    passwordRules.number.style.color = '#dc3545';
                    passwordRules.number.innerHTML = 'One number';
                }
                
                // Special character check
                if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) {
                    strength++;
                    passwordRules.special.style.color = '#198754';
                    passwordRules.special.innerHTML = '✓ One special character';
                } else {
                    passwordRules.special.style.color = '#dc3545';
                    passwordRules.special.innerHTML = 'One special character';
                }
                
                // Update strength meter
                passwordStrength.className = 'password-strength mt-2 strength-' + strength;
            });
            
            // Password match validation
            confirmPasswordInput.addEventListener('input', function() {
                if (this.value !== passwordInput.value) {
                    this.classList.add('is-invalid');
                } else {
                    this.classList.remove('is-invalid');
                }
            });
            
            // Form validation
            form.addEventListener('submit', function(event) {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                
                if (passwordInput.value !== confirmPasswordInput.value) {
                    event.preventDefault();
                    confirmPasswordInput.classList.add('is-invalid');
                }
                
                form.classList.add('was-validated');
            }, false);
        });
    </script>
</body>
</html>
